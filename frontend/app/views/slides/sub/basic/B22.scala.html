@implicitSlide = @{ Content.operatoren }

@defining(implicitSlide.label) { implicit topic =>

    @layout.slidedeck(topic) {

        @slidehead() {
            @topic
        } {

        }

        <!-- ################################################################################## -->

        @defining("Bezeichner") { title =>

            @slide(title = title) {

                @sidebyside(gap = 15) {

                    <em>erlaubt</em>

                    @indent() {
                        @spacer_half()

                        @callcode() {
                            |def x = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def _x2 = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def %/ = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def one_+ = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def √ = ()
                        }
                    }
                } {
                    <var>verboten</var>

                    @indent() {
                        @spacer_half()

                        @callcode() {
                            |def 123 = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def 2x = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def () = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def 2+ = ()
                        }

                        @spacer_half()

                        @callcode() {
                            |def √3 = ()
                        }
                    }
                }

                @infobox() {
                    Ein Bezeichner kann
                    <ul class="indent">
                        <li>alphanumerisch (beginnend mit einem Buchstaben, gefolgt von Ziffern oder Buchstaben)</li>
                        <li style="margin-top: 0;">oder symbolisch (Sequenz aus Operator-Symbolen)</li>
                    </ul>
                    sein. <code>_</code> zählt als Buchstabe und erlaubt die Kombination der beiden Typen.
                }
            }

            <!-- ################################################################################## -->

            @headslide(title = title, subtitle = "Backticks") {
                Backticks
            } {
                @spacer()

                @callcode() {
                    |val `val` = 42
                }
                @codesub2() {
                    <code>`</code> erlaubt Verwendung von Keywords
                }

                @spacer2()

                @callcode() {
                    Thread.`yield`()
                }
                @codesub2() {
                    u.a. hilfreich für Java-Integration
                }
            }
        }

        <!-- ################################################################################## -->

        @slide(title = "Notationen", clazz = "wide") {

            @sidebyside((66,33), gap = 6) {
                @sidebyside(gap = 8) {
                    @subhead(false) {
                        prefix
                    }

                    @spacer()

                    @callcode() {
                        |-1
                    }
                    @iseq()
                    @callcode() {
                        |1.unary_-()
                    }

                    @spacer2()

                    @callcode() {
                        |!true
                    }
                    @iseq()
                    @callcode() {
                        |true.unary_!
                    }

                    @spacer()

                    @infobox() {
                        Anwendbar für die Operatoren
                        <code>!</code>, <code>~</code>, <code>+</code> und <code>-</code>.
                    }
                } {
                    @subhead(false) {
                        infix
                    }

                    @spacer()

                    @callcode() {
                        |1 + 1
                    }
                    @iseq()
                    @callcode() {
                        |1.+(1)
                    }

                    @spacer2()

                    @callcode() {
                        |"abc" contains 'a'
                    }
                    @iseq()
                    @callcode() {
                        |"abc".contains('a')
                    }

                    @spacer()

                    @infobox() {
                        Anwendbar für Operatoren mit @uline("einem") Parameter.
                    }
                }
            } {
                @subhead(false) {
                    postfix
                }

                @spacer()

                @callcode() {
                    |1 toString
                }
                @iseq()
                @callcode() {
                    |1.toString()
                }

                @spacer2()

                @callcode() {
                    |1 toLong
                }
                @iseq()
                @callcode() {
                    |1.toLong()
                }

                @spacer()

                @infobox() {
                    Anwendbar für Operatoren @uline("ohne") Parameter.
                }
            }
        }

        <!-- ################################################################################## -->

        @quiz() {
            @Quiz.operator()
        }

        <!-- ################################################################################## -->

        @slide(title = "unär") {

            @sidebyside(gap = 8) {
                @callcode(id = "r", reference = "rational") {
                    |val r1 = new Rational(1, 2)
                }

                @spacer()

                @snippet() {
                    @callblock(reference = "r") {
                        |val r2 = -r1
                    }
                    @outblock() {
                        |r2: Rational = -1/2
                    }
                    @callblock() {
                        |val r3 = +r2
                    }
                    @outblock() {
                        |r3: Rational = 1/2
                    }
                    @callblock() {
                        |val r4 = ~r3
                    }
                    @outblock() {
                        |r4: Rational = 2/1
                    }
                    @callblock() {
                        |val r5 = r3.unary_~
                    }
                    @outblock() {
                        |r5: Rational = 2/1
                    }
                }
            } {
                @sourcecode(id = "rational") {
                    |class Rational(n: Int, d: Int) {
                    |
                    |  override def toString =
                    |    n + "/" + d
                    |
                    |  def unary_+ : Rational = {
                    |    import math._
                    |    new Rational(abs(n), abs(d))
                    |  }
                    |
                    |  def unary_- =
                    |    new Rational(-n, d)
                    |
                    |  def unary_~ =
                    |    new Rational(d, n)
                    |}
                }
            }

            @infobox() {
                Der Präfix <code>unary_</code> lässt <code>!</code>,
                <code>~</code>, <code>+</code> und <code>-</code> als unäre Operatoren verwenden.
            }
        }

        <!-- ################################################################################## -->

        @slide(title = "Vorrang") {

            @sidebyside(gap = 10) {
                @callcode() {
                    |5 + 5 * 2
                }
                @iseq()
                @callcode() {
                    |(5).+((5).*(2))
                }
                @codesub2() {
                    <code>*</code> hat Vorrang vor <code>+</code>
                }

                @spacer()

                @callcode() {
                    |5 + 5 toString
                }
                @iseq()
                @callcode() {
                    |((5).+(5)).toString()
                }
                @codesub2() {
                    Infix <code>+</code> hat Vorrang vor Postfix <code>toString</code>
                }

                @spacer()

                @callcode() {
                    |-5 + 5
                }
                @iseq()
                @callcode() {
                    |((5).unary_-).+(5)
                }
                @codesub2() {
                    Prefix <code>-</code> hat Vorrang vor Infix <code>+</code>
                }
            } {
                @infobox() {
                    <div>
                        Ein Prefix- wird vor einem Infix-Operator und
                        Infix- vor einem Postfix-Operator ausgeführt.
                    </div>
                    @spacer()
                    <div>
                        Ansonsten bestimmt das erste Zeichen des Operators die Reihenfolge:
                        @spacer_half()
                        <div class="indent">
                        <table>
                            <tr>
                                <td>alle anderen Sonderzeichen</td>
                            </tr>
                            <tr>
                                <td><code>*</code> <code>/</code> <code>%</code></td>
                            </tr>
                            <tr>
                                <td><code>+</code> <code>-</code></td>
                            </tr>
                            <tr>
                                <td><code>:</code></td>
                            </tr>
                            <tr>
                                <td><code>=</code> <code>!</code></td>
                            </tr>
                            <tr>
                                <td><code>&lt;</code> <code>&gt;</code></td>
                            </tr>
                            <tr>
                                <td><code>&amp;</code></td>
                            </tr>
                            <tr>
                                <td><code>^</code></td>
                            </tr>
                            <tr>
                                <td><code>|</code></td>
                            </tr>
                            <tr>
                                <td>alle Buchstaben</td>
                            </tr>
                            <tr>
                                <td>Zuweisungsoperatoren</td>
                            </tr>
                        </table>
                        </div>
                    </div>
                }
            }
        }

        <!-- ################################################################################## -->

        @titleslide(title = "Zuweisungsoperator") {

            @spacer()

            @callcode() {
                |x *= y + 1
            }
            @iseq()
            @callcode() {
                |x = x.*((y).+(1))
            }
            @codesub2() {
                Zuweisungen <code>=</code> haben die geringste Priorität
            }

            @spacer2()

            @callcode() {
                |1 == 1 + 1
            }
            @iseq()
            @callcode() {
                |1.==((1).+(1))
            }
            @codesub2() {
                Vergleichsoperatoren wie <code>&lt;=</code> usw. sind keine Zuweisungen
            }
        }

        <!-- ################################################################################## -->

        @titleslide(title = "Assoziativität") {

            @autocenter {
                @callcode() {
                    |15 - 3 + 6
                }
                @iseq()
                @callcode() {
                    |(15 - 3) + 6
                }
                @codesub2() {
                    @uline("fast") alle Operatoren sind <em>links-assoziativ</em>
                }
            }

            @spacer()

            <h4 class="tcenter fragment">Ausnahmen:</h4>

            @spacer_half()

            @sidebyside(gap = 15) {

                @callcode() {
                    |val i = 1 + 1
                }
                @codesub2() {
                    Zuweisungen
                }

            } {
                @callcode() {
                    |1 :: 2 :: List()
                }
                @iseq()
                @callcode() {
                    |1 :: (2 :: List())
                }
                @iseq()
                @callcode() {
                    |(List().::(2)).::(1)
                }
                @codesub2() {
                    Operatoren die mit <code>:</code> enden
                }
            }
        }

        <!-- ################################################################################## -->

        @uebung(implicitSlide.id)
    }
}