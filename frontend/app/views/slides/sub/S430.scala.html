@slide(title = "Rekursion") {
    Rekursion
} {
    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock(fragment = false) {
                |def factorial(n: Int): BigInt = {
                |   var acc = BigInt(1)
                |   for (i <- 2 to n) {
                |     acc *= i
                |   }
                |   acc
                |}
            }
            @outblock() {
                |factorial: (n: Int)Int
            }
            @callblock() {
                |factorial(4)
            }
            @outblock() {
                |res0: BitInt = 24
            }
            @callblock() {
                |factorial(10000)
            }
            @outblock() {
                |res1: BigInt = 2846259680917054518906..
            }
        }
        <div>

        </div>
    </div>
}


@slide() {
} {
    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock(fragment = false) {
                |def factorial(n: Int) =
                |   if (n == 0) BigInt(1) else n * factorial(n - 1)
            }
            @outblock(error = true) {
                |error: recursive method factorial needs result type
            }
        }
        <div>

        </div>
    </div>

    <hr/>

    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock() {
                |def factorial(n: Int): BigInt =
                |   if (n == 0) BigInt(1) else n * factorial(n - 1)
            }
            @outblock() {
                |factorial: (n: Int)BigInt
            }
            @callblock() {
                |factorial(4)
            }
            @outblock() {
                |res0: BitInt = 24
            }
            @callblock() {
                |factorial(10000)
            }
            @outblock(error = true) {
                |java.lang.StackOverflowError
            }
        }
        <div>
            @codenote() {

            }
        </div>
    </div>
}


@slide() {
    <!-- @@tailrec I -->
} {
    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock(fragment = false) {
                |import scala.annotation.tailrec
                |
                |@@tailrec
                |def factorial(n: Int): BigInt =
                |   if (n == 0) BigInt(1) else n * factorial(n - 1)
            }
        }
        <div>
            @codenote() {
                Annotation <code>@@tailrec</code> stellt sicher,
                dass der Compiler die rekursive Funktion intern in eine Schleife umwandelt
            }
        </div>
    </div>
    <div class="sidebyside p60_40">
        @snippet() {
            @outblock(error = true) {
                |error: could not optimize @@tailrec annotated method:
                |       contains recursive call not in tail position
            }
        }
        <div>
            @codenote() {
                <var>Bedingung:</var> letzte Anweisung ist Rekursionsaufruf
            }
        </div>
    </div>

    <hr/><hr/>

    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock() {
                |import scala.annotation.tailrec
                |
                |@@tailrec
                |def factorial(n: Int, acc: BigInt): BigInt =
                |   if (n == 0) acc else factorial(n - 1, acc * n)
            }
        }
        <div>
            @codenote() {
                Zwischenergebnis der Multiplikation wird zu Parameter
            }
        </div>
    </div>
    <div class="sidebyside p60_40">
        @snippet() {
            @outblock() {
                |factorial: (n: Int, acc: BigInt)BigInt
            }
        }
        <div>
            @codenote() {
                <var>Nachteil:</var> Hilfsparameter ist Teil der Signatur
            }
        </div>
    </div>
}

@slide() {
    <!-- @@tailrec II -->
} {
    <div class="sidebyside p60_40">
        @snippet() {
            @sourceblock(id = "tailrec", fragment = false) {
                |import scala.annotation.tailrec
                |
                |def factorial(n: BigInt): Int = {
                |  @@tailrec
                |  def factorial(n: Int, acc: BigInt): Int =
                |    if (n == 0) acc else factorial(n - 1, acc * n)
                |
                |  factorial(n, 1)
                |}
            }
            @outblock() {
                |factorial: (n: Int)BigInt
            }
        }
        <div>
            @codenote() {
                <em>LÃ¶sung:</em>
                Definition einer internen Methode
            }
        </div>
    </div>

    <hr/><hr/>

    <div class="sidebyside p60_40">
        @snippet() {
            @callblock(reference = "tailrec") {
                |factorial(4)
            }
            @outblock() {
                |res0: BitInt = 24
            }
            @callblock() {
                |factorial(10000)
            }
            @outblock() {
                |res1: BigInt = 2846259680917054518906..
            }
        }
        <div>
            @codenote() {
                Kein <code>StackOverflow</code> mehr
            }
        </div>
    </div>
}