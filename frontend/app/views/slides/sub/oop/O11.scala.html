@implicitSlide = @{ Content.vererbung1 }

@defining(implicitSlide.label) { implicit topic =>

    @layout.slidedeck(topic) {

        @slidehead() {
            @topic
        } {
            @image("inheritance.png", width = 550, clazz = "naked")
        }

        <!-- ################################################################################## -->

        @titleslide(title = "extends") {

            @sidebyside(gap = 10) {
                @subhead() {
                    (A) Klassen
                }

                @snippet() {
                    @sourceblock() {
                        |class Employee
                        |
                        |class Boss extends Employee
                    }
                    @outblock() {
                        |defined class Employee
                        |defined class Boss
                    }
                }

                @codesub2() {
                    Klasse <code>Boss</code> erbt von <code>Employee</code>
                }
            } {
                @subhead() {
                    (B) Objekte
                }

                @snippet() {
                    @sourceblock() {
                        |class Employee
                        |
                        |object Employee extends Employee
                    }
                    @outblock() {
                        |defined class Employee
                        |defined module Employee
                    }
                }

                @codesub2() {
                    Objekt <code>Employee</code> erbt von <code>Employee</code>
                }
            }

            @*@infobox() {
                Mittels <code>extend</code> erben Klassen und Objekte von (maximal) einer anderen Klasse.
            }*@
        }

        <!-- ################################################################################## -->

        @titleslide(title = "Konstruktor") {

            @autocenter {
                @sourcecode(id = "empl1") {
                    |class Employee (val name: String)
                }
                @codesub2() {
                    <code>Employee</code> erwartet den Parameter <code>name</code>
                }
            }

            @spacer2()

            @sidebyside(gap = 10) {

                @sourcecode(reference = "empl1") {
                    |class Developer (name: String, val age: Int)
                    |   extends Employee (name)
                }
                @codesub2() {
                    <code>Developer</code> gibt den Parameter <code>name</code> an <code>Employee</code> weiter
                }

            } {
                @sourcecode(reference = "empl1") {
                    |class Boss
                    |   extends Employee ("Sir")
                }
                @codesub2() {
                    <code>Boss</code> ruft primären Konstruktor von <code>Employee</code> mit Konstante auf
                }
            }

            @*@infobox() {
                Bei der Vererbung muss der primäre Konstruktor der erbende Klasse
                den primären Konstruktor der vererbten Klasse aufrufen.
            }*@
        }

        <!-- ################################################################################## -->

        @slide(title = "sealed & final") {

            @spacer()

            @sidebyside(gap = 10) {
                @subhead() {
                    final
                }

                @snippet() {
                    @sourceblock() {
                        |final class Employee
                        |
                        |class Accountant extends Employee
                    }
                    @outblock(error = true) {
                        |error: illegal inheritance
                        |       from final class Employee
                    }
                }

                @codesub2() {
                    <code>final</code> verhindert jede weitere Vererbung
                }

            } {
                @subhead() {
                    sealed
                }

                @snippet() {
                    @sourceblock() {
                        |// Employee.scala
                        |sealed class Employee
                        |
                        |class Developer extends Employee
                    }
                }

                @spacer()

                @snippet() {
                    @sourceblock() {
                        |// Accountant.scala
                        |class Accountant extends Employee
                    }
                    @outblock(error = true) {
                        |error: illegal inheritance
                        |       from sealed class Employee
                    }
                }

                @codesub2() {
                    <code>sealed</code> verhindert Vererbung außerhalb der Datei
                }
            }

            @*@infobox() {
                <code>final</code> verhindert, dass eine Klasse vererbt werden kann;
                <code>sealed</code> verhindert, dass eine Klasse außerhalb der Quelldatei vererbt werden kann.
            }*@
        }

        <!-- ################################################################################## -->

        @defining("override") { title =>

            @spacer()

            @slide(title = title) {

                <div class="w40p dcenter">
                    @sourcecode(id = "empl2") {
                        |class Employee {
                        |  val salary = 40000
                        |}
                    }
                </div>

                @spacer2()

                @sidebyside(gap = 10) {
                    @snippet() {
                        @sourceblock(reference = "empl2") {
                            |class Boss extends Employee {
                            |  val salary = 100000
                            |}
                        }
                        @outblock(error = true) {
                            |error: value salary needs
                            |       `override' modifier
                        }
                    }
                } {
                    @snippet() {
                        @sourceblock(reference = "empl2") {
                            |class Boss extends Employee {
                            |  override val salary = 100000
                            |}
                        }
                        @outblock() {
                            |defined class Boss
                        }
                    }
                    @codesub2() {
                        via <code>override</code> werden Felder & Methoden überschrieben
                    }
                }
            }

            <!-- ################################################################################## -->

            @slide(title = title) {

                <div class="w40p dcenter">
                    @sourcecode(id = "empl3") {
                        |class Employee {
                        |  val salary = 40000
                        |}
                    }
                </div>

                @spacer2()

                @sidebyside(gap = 10) {

                    @snippet() {
                        @sourceblock(reference = "empl3") {
                            |class Boss extends Employee {
                            |   override val salry = 100000
                            |}
                        }
                        @outblock(error = true) {
                            |error: value salry overrides nothing
                        }
                    }
                    @codesub2() {
                        überprüft Namen
                    }
                } {
                    @snippet() {
                        @sourceblock(reference = "empl3") {
                            |class Boss extends Employee {
                            |   override val salary = 100000.0
                            |}
                        }
                        @outblock(error = true) {
                            |error: overriding value salary;
                            |       value salary has incompatible type
                        }
                    }
                    @codesub2() {
                        überprüft Typen
                    }
                }

                @*
                @infobox() {
                    Durch den erforderlichen Modifier <code>override</code> wird vom Compiler erkannt,
                    ob Name, Parameter und Rückgabetyp mit der überschriebenen Methode übereinstimmen.
                }
                *@
            }

            <!-- ################################################################################## -->

            @headslide(title = title, subtitle = "def <> val") {
                def &lt;&gt; val
            } {
                @spacer()

                @sidebyside(gap = 10) {
                    @subhead() {
                        def -> val
                    }

                    @snippet() {
                        @sourceblock() {
                            |class Employee (name: String) {
                            |
                            |  override val toString =
                            |     "Employee[name=" + name + "]"
                            |}
                        }
                    }
                    @codesub2() {
                        Methode ohne Parameter wird zu einem <code>val</code>
                    }

                } {
                    @subhead() {
                        val -> def
                    }

                    @snippet() {
                        @sourceblock() {
                            |class Employee {
                            |   val salary = 40000
                            |}
                            |
                            |class Developer (age: Int)
                            |   extends Employee {
                            |
                            |   override def salary =
                            |      20000 + age * 1000
                            |}
                        }
                        @outblock(error = true) {
                            |error: method salary needs to
                            |       be a stable, immutable value
                        }
                    }
                    @codesub2() {
                        <code>val</code> aber <var>nicht</var> zu einer Methode
                    }
                }

                @*@infobox() {
                    Eine Methode ohne Parameter kann durch ein <code>val</code> überschrieben werden;<br/>
                    das erhöht den Speicherverbrauch, verbessert aber die Performance.
                }*@
            }

            <!-- ################################################################################## -->

            @headslide(title = title, subtitle = "final") {
                final
            } {
                @spacer()

                @snippet() {
                    @sourceblock(id = "final-members") {
                        |class Employee {
                        |   final val salary = 40000
                        |}
                    }
                }

                @spacer()

                @indent() {
                    @snippet() {
                        @sourceblock(reference = "final-members") {
                            |class Accountant extends Employee {
                            |   override val salary = 50000
                            |}
                        }
                        @outblock(error = true) {
                            |error: value salary cannot
                            |       override final member
                        }
                    }
                    @codesub2() {
                        <code>final</code> verhindert das Überschreiben
                    }
                }

                @*@infobox() {
                    Durch den Modifier <code>final</code> vor einem Feld oder einer Methode kann das Überschreiben
                    in einer Sub-Klasse verhindert werden.
                }*@
            }
        }

        <!-- ################################################################################## -->

        @titleslide(title = "super") {

            @snippet() {
                @sourceblock(id = "super") {
                    |class Employee (name: String) {
                    |
                    |   override def toString =
                    |       super.toString + "[name=" + name + "]"
                    |}
                }
            }
            @codesub2() {
                <code>super</code> ermöglicht Zugriff auf Basis-Klasse
            }

            @spacer()

            @snippet() {
                @callblock(reference = "super") {
                    |val p = new Employee("Bob")
                }
                @outblock() {
                    |p: Employee = Employee@@4088e7c9[name=Bob]
                }
            }

            @spacer()

            @*@infobox() {
                Mit Hilfe von <code>super</code> kann explizit auf Methoden und Felder der vererbten Klasse zugegriffen werden.
            }*@
        }

        <!-- ################################################################################## -->

        @titleslide(title = "anonym") {

            @snippet() {
                @sourceblock() {
                    |class Employee (val name: String)
                }
                @callblock() {
                    |val e = new Employee("Bob") {
                    |   override def toString = name
                    |}
                }
                @outblock() {
                    |e: Employee = Bob
                }
            }
            @codesub2() {
                Felder überschreiben / hinzufügen kann <br/> auch erst bei Instanziierung erfolgen
            }
        }

        <!-- ################################################################################## -->

        @defining("abstract") { title =>

            @titleslide(title = title) {

                @snippet() {
                    @sourceblock() {
                        |class Employee {
                        |   val salary: Int
                        |}
                    }
                    @outblock(error = true) {
                        |error: class Employee needs to be abstract,
                        |       since value salary is not defined
                    }
                }

                @spacer()

                @snippet() {
                    @sourceblock() {
                        |abstract class Employee {
                        |   val salary: Int
                        |}
                    }
                    @outblock() {
                        |defined class Employee
                    }
                }
                @codesub2() {
                    <code>abstract</code> markiert Klassen
                    die mind. ein Feld oder eine Methode <br/> ohne Implementierung enthalten
                }
            }

            <!-- ################################################################################## -->

            @titleslide(title = title) {

                @autocenter {
                    @snippet() {
                        @sourceblock(id = "abstract") {
                            |abstract class Employee {
                            |   val salary: Int
                            |}
                        }
                    }
                }

                @spacer()

                @sidebyside(gap = 10) {

                    @snippet() {
                        @sourceblock(reference = "abstract") {
                            |class Accountant extends Employee
                        }
                        @outblock(error = true) {
                            |error: class Accountant needs to
                            |       be abstract, since value
                            |       salary is not defined
                        }
                    }

                } {
                    @snippet() {
                        @sourceblock(reference = "abstract") {
                            |class Accountant extends Employee {
                            |   val salary = 60000
                            |}
                        }
                        @outblock() {
                            |defined class Accountant
                        }
                    }

                    @iseq()

                    @snippet() {
                        @sourceblock(reference = "abstract") {
                            |class Accountant extends Employee {
                            |   override val salary = 60000
                            |}
                        }
                        @outblock() {
                            |defined class Accountant
                        }
                    }
                    @codesub2() {
                        <code>override</code> ist hier <em>optional</em>
                    }
                }
            }
        }

        <!-- ################################################################################## -->

        @uebung(implicitSlide.id)
    }
}