<!--
    - higher order functions
    - map
    - fold
    - filter
-->
@implicitSlide = @{ Content.funktionen3 }

@defining(implicitSlide.label) { implicit topic =>

    @layout.slidedeck(topic) {

        @slidehead() {
            @topic
        } {

        }

        <!-- ################################################################################## -->

        @defining("HOF") { title =>

            @defining("foreach") { subtitle =>

                @headslide(title = title, subtitle = subtitle) {
                    @subtitle
                } {

                }
            }

            <!-- ################################################################################## -->

            @defining("map") { subtitle =>

                @headslide(title = title, subtitle = subtitle) {
                    @subtitle
                } {

                }
            }

            <!-- ################################################################################## -->

            @defining("filter") { subtitle =>

                @headslide(title = title, subtitle = subtitle) {
                    @subtitle
                } {
                    @autocenter {
                        @sourcecode() {
                            |trait Traversable[A] {
                            |  def filter (f: A => Boolean): Traversable[A]
                            |}
                        }
                        @*@codesub2() {
                            Methode vom Typ <code>A</code> wendet Funktion <code>f</code>
                            auf alle Elemente an und liefert neue Kollektion mit Elemente
                        }*@
                    }

                    @spacer2()

                    @sidebyside(gap = 10) {
                        @snippet() {
                            @callblock() {
                                |val numbers = List (1, 2, 3, 4)
                                |
                                |numbers filter ((n: Int) => n % 2 == 0)
                            }
                            @outblock() {
                                |res0: List[Int] = List(2, 4)
                            }
                        }
                        @codesub2() {
                            Liste der geraden Zahlen
                        }
                    } {
                        @snippet() {
                            @callblock() {
                                |val numbers = List (1, 2, 3, 4)
                                |
                                |numbers filter {(n: Int) =>
                                |   val isEven = (n % 2 == 0)
                                |   println (n + "? " + isEven)
                                |   isEven
                                |}
                            }
                            @outblock() {
                                |1? false
                                |2? true
                                |3? false
                                |4? true
                                |res0: List[Int] = List(1, 2)
                            }
                        }
                        @codesub2() {
                            mit Zwischenschritten
                        }
                    }
                }
            }
        }

        <!-- ################################################################################## -->

        @quiz() {
            @Quiz.functions3()
        }

        <!-- ################################################################################## -->

        @defining("foldLeft") { title =>

            @titleslide(title = title) {

                @*
                println((1 to 1000000) reduceLeft(_ + _))  // tail rec
                println((1 to 1000000) reduceRight(_ + _)) // overflow
                *@

                @autocenter {
                    @sourcecode() {
                        |trait Traversable[A] {
                        |  def foldLeft[B] (z: B) (f: (B, A) => B): B
                        |}
                    }
                    @*@codesub2() {
                        Methode vom Typ <code>B</code>, mit Startwert <code>z</code> vom Typ <code>B</code>,
                        wendet Funktion <code>f</code> auf jedes Element an und liefert Ergebnis vom Typ <code>B</code>
                    }*@
                }

                @spacer2()

                @sidebyside(gap = 10) {

                    @snippet() {
                        @callblock() {
                            |val numbers = List (1, 2, 3, 4)
                            |
                            |numbers.foldLeft (0) (
                            |   (res, num) => res + num
                            |)
                        }
                        @outblock() {
                            |res0: Int = 10
                        }
                    }
                    @codesub2() {
                        Summe der Elemente
                    }
                } {
                    @snippet() {
                        @callblock() {
                            |val numbers = List (1, 2, 3, 4)
                            |
                            |numbers.foldLeft (0) {
                            |  (res, num) =>
                            |    println ("= " + res + " + " + num)
                            |    res + num
                            |}
                        }
                        @outblock() {
                            |= 0 + 1
                            |= 1 + 2
                            |= 3 + 3
                            |= 6 + 4
                            |res1: Int = 10
                        }
                    }
                    @codesub2() {
                        mit Zwischenergebnissen
                    }
                }
            }
        }

        <!-- ################################################################################## -->

        @slide(title = "flatMap") {
            @*
            def getConfig(s: String) =
                Option(System.getProperty(s))

            def toNum(s: String) =
                try {
                    Some(s.toDouble)
                } catch {
                    case e: Throwable => None
                }

            val r = getConfig("os.version") map (s => toNum(s))

            val r2 = getConfig("os.version") flatMap (s => toNum(s))
            *@
        }

        <!-- ################################################################################## -->

        @slide(title = "Beispiel") {

        }

        <!-- ################################################################################## -->

        @uebung(implicitSlide.id)
    }
}